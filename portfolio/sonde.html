<!DOCTYPE html>
<html>
<head>
<style>
    html { background-color: #f6f6f6 }
    main { background-color: white; padding: 1vw; font-size: 4vw; 
        font-family: Arial; height: 98%; color: }
    h1 {text-align: center; font-size: 8vw; margin: 1% auto 3% auto;}
    .section { width: 98%; margin: auto; }
    #btn--calc { position: fixed; margin-inline: auto;
  bottom: 1vh; right: 4%; width:92%; font-size: 5vw; text-align: center; 
                padding: 2vw; border-radius: 1vw; margin-bottom: 1vw;}
    .form-1 { display: grid; grid-template-columns: 1fr 1fr; gap: 3vw;}
    .div--weight {display: grid; grid-template-columns: 28% 47% 25%; gap: 1vw;
                    border: 1px solid #222222; padding: 2vw; 
                    border-radius: 2vw;}
    .div--height {display: grid; grid-template-columns: 28% 47% 25%; gap: 1vw;
                    border: 1px solid #222222; border-radius: 2vw;
                    padding: 2vw; }

    .form-2 { margin-top: 2%; }
    .div--restriction { display: grid; grid-template-columns: 35% 20% 10% 25%; gap: 1vw;
                    border: 1px solid #222222; border-radius: 2vw;
                    padding: 2vw; }            
              
.input--field { margin: 0; font-size: 4vw; width: 95%; padding: 2px; } 
.output { width: 96%; height: 60vh; background-color: #f6f6f6; 
        border: 1px solid #222222; margin: 2% auto ; padding: 1%; 
        border-radius: 5px;}
</style>
<script>
function calcFun(){
	let weight = document.getElementById("weight").value || 80; /* Definerer Vægt */
    let height = document.getElementById("height").value || 175; /* Definerer Højde */
    let bmi = (weight/((height/100)*(height/100))).toFixed(2); /* Udregner BMI */
    let liquidDemand = weight*30; /* Udregner væskebehov */
	let energyDemand = 0; /* Deklarer variabel for Energibehov -> udregnes senere */
    let restriction = document.getElementById("restriction").value || 0; /* Definerer væskerestriktion */
    /* Hvis der er ordineret væskerestriktion sættes væskebehovet til den ordinerede mængde */
	if(restriction > 0){ liquidNeed = restriction} 
    let nutrision = 0; /* Denne variabel bruges til at sætte mængden af sondeernæring */

	/* Hvis patienten har et BMI >= 30 skal ernæringsbehovet udregnes udfra ernæringsvægten
 	   Når BMI er under 30 skal variablen være udefineret */
    let nutriWeight = ""; 
    if(bmi >= 30){ nutriWeight = Math.round((height - 100)+((weight-(height-100))/3)); 
		  energyDemand = nutriWeight*27;} else
    		{ energyDemand = weight*27 } /* Udregning af energibehov */
/* Energi og væskemængde i sondeproduktet - !! kan senere bruges til at varierer efter produktvalg!! */
	let productKcal = 1.5;
	let productWater = 0.76;
    /* Udregning af sondemængde ved BMI >= 30 ud fra ernæringsvægt */
    if(bmi >= 30){ 
        nutrision = Math.round((((nutriWeight*27)/productKcal)/5)/10)*10;
    } else
    {
    if(weight < 45){ nutrision = 160 } else 
    if(weight >= 45 & weight < 60) { nutrision = 200 } else
    if(weight >= 60 & weight < 75) { nutrision = 220 } else
    if(weight >= 75 & weight < 85) { nutrision = 260 } else
    if(weight >= 85 & weight < 100) { nutrision = 280 } else
    if(weight >= 100 & weight < 115) { nutrision = 320 } }

    let liquidInProduct = Math.round(5 * nutrision * productWater); /* Udregner væskemængden i sondeernæringen */
    let liquidExtra = Math.round(((liquidDemand - liquidInProduct)/5)/10)*10;

    let output = "Vægt: " + weight + " kg [Ernæringsvægt: " + nutriWeight + " kg]<br>" + 
                "BMI: " + bmi + 
                "<br><br><b>Sondeplan</b>:<br>5 x <u>" + 
                nutrision + "</u> ml PPEMF <br>" +
                "<br><b>Væskeberegning</b>: <br>" + 
                "Væskebehov: " + liquidNeed + " ml<br>" +
                "Væske i sondemaden:" + liquidInProduct +
                " ml<br>Skyllevæske: 5 x <u>" + liquidExtra + "</u> ml" +
                "<br>";

    return output;
}
</script>
</head>
<body>
    <main><section class="section">
        <h1 class="heading--h1">Sondeudregning</h1>
        <form class="form-1">
        <div class="div--weight">
            <label for="weight">Vægt:</label>
            <input type="text" placeholder="kg" id="weight" class="input--field input--weight">
            <span>kg</span>
        </div>
        <div class="div--height">
            <label for="height">Højde:</label>
            <input type="text" placeholder="cm" id="height" class="input--field input--height">
            <span>cm</span>
        </div> 
        </form>
        <form class="form-2">       
        <div class="div--restriction">
            <label for="restriction">Væskerestriktion:</label>
            <input type="text" placeholder="ml" id="restriction" class="input--field input--height">
            <span> ml</span>
            <span style="font-size: 2vw;">
                Udfyldes kun hvis der er ordineret væskerestriktion</span>
        </div> 
		<!-- HER INDSÆTTES STRUKTUR FOR PRODUKTVALG
		## Drop-down menu med mulige produkter
		## - Nutrison Protein Plus Energy Multi Fibre (Standard)
		## - 2 kcal
		## - Low Sodium
		## - Soya
<div class="div--product">
		<select name="product" id="product">
  			<option value="ppeml">Nutrison Protein Plus Energy Multi Fibre</option>
  			<option value="HP2kcal">Saab</option>
  			<option value="lowsodium">Mercedes</option>
		</select>
	</div>
		-->
        </form>
        
        
        <div class="output" id="output"> </div>
        <button id="btn--calc" 
                onclick="document.getElementById('output').innerHTML = calcFun()">
            Beregn</button>
    </section>
    </main>
</body>
</html>
